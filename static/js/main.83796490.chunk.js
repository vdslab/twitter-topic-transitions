(this["webpackJsonptwitter-topic-transitions"]=this["webpackJsonptwitter-topic-transitions"]||[]).push([[0],{188:function(e,t,n){},199:function(e,t,n){"use strict";n.r(t);var c=n(0),i=(n(186),n(187),n(188),n(19)),r=n(2),s=n(20),a=n(5),o=n.n(a),l=n(11),u=n(1),d=n(3),j=n(4),b=n(71),f=n.n(b),h=n(72),x=n.n(h),m=n(73),p=n.n(m),O=f()().dbscan,v=x()().layout,g=(p()().tsne,n(16));function w(e,t,n){if(0===e.length)return{x:0,y:0,s:1};var c=Math.min.apply(Math,Object(g.a)(e.map((function(e){return e.x-e.r})))),i=Math.max.apply(Math,Object(g.a)(e.map((function(e){return e.x+e.r})))),r=Math.min.apply(Math,Object(g.a)(e.map((function(e){return e.y-e.r})))),s=i-c,a=Math.max.apply(Math,Object(g.a)(e.map((function(e){return e.y+e.r}))))-r;return{x:c+s/2,y:r+a/2,s:Math.min(t/s,n/a)}}var y=function(e,t,n,c){var i=document.createElementNS("http://www.w3.org/2000/svg","text");i.textContent=e,i.setAttributeNS(null,"font-family",n),i.setAttributeNS(null,"font-weight",c);var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.appendChild(i),document.body.appendChild(r);for(var s=0,a=100,o=0;o<10;++o){var l=(s+a)/2;i.setAttributeNS(null,"font-size",l);var u=i.getBBox(),d=u.width,j=u.height;Math.sqrt(Math.pow(d,2)+Math.pow(j,2))/2<=t?s=l:a=l}return document.body.removeChild(r),s},N=function(e){return new Date(e.time).getTime()};function k(e){var t=new Date(e.time),n=new Date(e.stopTime);return 36e5*e.tweetCount/(n-t)}function C(){return T.apply(this,arguments)}function T(){return(T=Object(l.a)(o.a.mark((function e(){var t,n,c,i,r,s,a,l,u,b,f,h,x,m,p,g;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("fukushimaData.json");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c=j.g(j.b).domain(j.a(n.dailyCount,N)),i=Object(d.a)(n.dailyCount);try{for(i.s();!(r=i.n()).done;)(s=r.value).color=c(N(s))}catch(o){i.e(o)}finally{i.f()}a=j.h().domain(j.a(n.topics,k)).range([3,15]),l=Object(d.a)(n.topics);try{for(l.s();!(u=l.n()).done;)(b=u.value).tweetPerHour=k(b),b.r=0,b.r0=a(b.tweetPerHour),b.color=c(N(b))}catch(o){l.e(o)}finally{l.f()}return f=j.h().domain(j.a(n.words,(function(e){return e.count}))).range([10,50]),n.words.forEach((function(e,t){e.x*=10,e.y*=10,e.r=f(e.count),e.fontSize=y(e.word,e.r,"700")})),h=20,e.next=17,O(n.words.map((function(e){return[e.x,e.y]})),h,2);case 17:return x=e.sent,(m=x.clusters).forEach((function(e,t){var c,i=Object(d.a)(e);try{for(i.s();!(c=i.n()).done;){var r=c.value;n.words[r].cluster=t}}catch(o){i.e(o)}finally{i.f()}})),e.next=22,v(n.words,h);case 22:return p=e.sent,g=j.f(j.j),n.words.forEach((function(e,t){var n=p[t],c=n.x,i=n.y;e.x=c,e.y=i,e.color=void 0===e.cluster?"lightgray":g(e.cluster)})),n.wordClusters=m,e.abrupt("return",n);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=Object(s.b)({name:"app",initialState:{topics:[],words:[],dailyCount:[],topicClusters:[],wordClusters:[],selectionRadius:3,selectedTopics:[],selectedWords:[],minWordCount:0},reducers:{loadData:function(e,t){return Object.assign({},e,t.payload)},updateSelectionRadius:function(e,t){return Object.assign({},e,{selectionRadius:t.payload})},selectTopics:function(e,t){return Object.assign({},e,{selectedTopics:t.payload})},updateMinWordCount:function(e,t){return Object.assign({},e,{minWordCount:t.payload})},toggleWord:function(e,t){var n=t.payload,c=e.selectedWords.indexOf(n),i=Array.from(e.selectedWords);return c<0?i.push(n):i.splice(c,1),Object.assign({},e,{selectedWords:i})}}}),D=n(13);function S(e){var t=e.render,n=Object(u.useRef)(),i=Object(u.useState)(0),r=Object(D.a)(i,2),s=r[0],a=r[1],o=Object(u.useState)(0),l=Object(D.a)(o,2),d=l[0],j=l[1];return Object(u.useEffect)((function(){function e(){a(n.current.clientWidth),j(n.current.clientHeight)}return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(c.jsx)("div",{style:{width:"100%",height:"100%"},ref:n,children:t(s,d)})}function z(e){var t=e.label,n=e.children;return Object(c.jsxs)("div",{className:"field is-horizontal",children:[Object(c.jsx)("div",{className:"field-label is-normal",children:Object(c.jsx)("label",{className:"label",children:t})}),Object(c.jsx)("div",{className:"field-body",children:n})]})}function M(e){var t=e.width,n=e.height,i=Object(r.b)(),s=Object(r.c)((function(e){return e.topics})),a=Object(r.c)((function(e){return e.selectionRadius})),u=Object(r.c)((function(e){var t=e.selectedTopics;return new Set(t)})),b=10,f=10,h=t-b-10,x=n-f-10,m=w(s,h,x),p=m.x,v=m.y,g=m.s;function y(e){return(e-p)*g}function N(e){return(e-v)*g}var k=j.c().x((function(e){return y(e.x)})).y((function(e){return N(e.y)})),C=j.k("%Y-%m-%d %H:%M");return Object(c.jsx)("svg",{viewBox:"0 0 ".concat(t," ").concat(n),children:Object(c.jsx)("g",{transform:"translate(".concat(b,", ").concat(f,")"),children:Object(c.jsxs)("g",{transform:"translate(".concat(h/2,",").concat(x/2,")"),children:[Object(c.jsx)("g",{children:Object(c.jsx)("path",{fill:"none",stroke:"lightgray",strokeWidth:"3",opacity:"0.5",d:k(s)})}),Object(c.jsx)("g",{children:s.map((function(e,t){return Object(c.jsx)("g",{className:"is-clickable",opacity:0===u.size||u.has(e.id)?1:.1,style:{transitionProperty:"opacity",transitionDuration:"1s",transitionTimingFunction:"ease"},transform:"translate(".concat(y(e.x),", ").concat(N(e.y),")"),onClick:Object(l.a)(o.a.mark((function t(){var n,c,r,l,j,b,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.has(e.id)){t.next=3;break}return i(W.actions.selectTopics([])),t.abrupt("return");case 3:return t.next=5,O(s.map((function(e){return[e.x,e.y]})),a,1);case 5:n=t.sent,c=n.clusters,r=Object(d.a)(c),t.prev=8,r.s();case 10:if((l=r.n()).done){t.next=32;break}j=l.value,b=Object(d.a)(j),t.prev=13,b.s();case 15:if((f=b.n()).done){t.next=22;break}if(f.value!==e.id){t.next=20;break}return i(W.actions.selectTopics(j)),t.abrupt("return");case 20:t.next=15;break;case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(13),b.e(t.t0);case 27:return t.prev=27,b.f(),t.finish(27);case 30:t.next=10;break;case 32:t.next=37;break;case 34:t.prev=34,t.t1=t.catch(8),r.e(t.t1);case 37:return t.prev=37,r.f(),t.finish(37);case 40:case"end":return t.stop()}}),t,null,[[8,34,37,40],[13,24,27,30]])}))),children:Object(c.jsx)("circle",{r:e.r0,opacity:"0.7",fill:e.color,children:Object(c.jsxs)("title",{children:[C(new Date(e.time)),"-",C(new Date(e.stopTime))]})})},t)}))})]})})})}function A(){var e=Object(r.b)(),t=Object(r.c)((function(e){return e.selectionRadius}));return Object(c.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[Object(c.jsx)("div",{className:"p-3",children:Object(c.jsx)(z,{label:"Selection Radius",children:Object(c.jsxs)("div",{className:"field has-addons",children:[Object(c.jsx)("div",{className:"control",children:Object(c.jsx)("button",{disabled:t<=0,className:"button",onClick:function(){e(W.actions.updateSelectionRadius(t-1))},children:Object(c.jsx)("span",{className:"icon",children:Object(c.jsx)("i",{className:"fas fa-minus"})})})}),Object(c.jsx)("div",{className:"control is-expanded",children:Object(c.jsx)("input",{className:"input",type:"number",min:"0",value:t,onChange:function(t){e(W.actions.updateSelectionRadius(+t.target.value))}})}),Object(c.jsx)("div",{className:"control",children:Object(c.jsx)("button",{className:"button",onClick:function(){e(W.actions.updateSelectionRadius(t+1))},children:Object(c.jsx)("span",{className:"icon",children:Object(c.jsx)("i",{className:"fas fa-plus"})})})})]})})}),Object(c.jsx)("div",{style:{position:"absolute",top:"64px",right:0,bottom:0,left:0},children:Object(c.jsx)(S,{render:function(e,t){return Object(c.jsx)(M,{width:e,height:t})}})})]})}function B(e){var t=e.width,n=e.height,i=Object(r.b)(),s=Object(r.c)((function(e){return e.topics})),a=Object(r.c)((function(e){return e.words})),o=Object(r.c)((function(e){return e.dailyCount})),l=Object(r.c)((function(e){var t=e.topics;return e.selectedTopics.map((function(e){return t[e]}))})),u=Object(r.c)((function(e){var t=e.selectedWords;return new Set(t)})),d=Object(r.c)((function(e){return e.minWordCount})),b=20,f=60,h=t-f-60,x=n-b-50,m="#363636",p=h/o.length+1,O=j.k("%Y-%m-%d"),v=j.i().domain(j.a(o,(function(e){return new Date(e.time)}))).range([p/2,h-p/2]),g=j.e().domain([0,j.d(o,(function(e){return e.tweetCount}))]).range([0,x]).nice(),w=j.e().domain([0,j.d(o,(function(e){return 0===u.size?100:j.d(Array.from(u),(function(t){return e.words[t]}))}))]).range([x,0]).nice();return Object(c.jsx)("svg",{width:t,height:n,children:Object(c.jsxs)("g",{transform:"translate(".concat(f,",").concat(b,")"),children:[Object(c.jsx)("g",{children:o.map((function(e,t){var n=new Date(e.time),r=new Date(n.getTime()+864e5),a=0===l.length||l.some((function(e){var t=new Date(e.time),c=new Date(e.stopTime);return n<=c&&t<=r}));return Object(c.jsxs)("g",{style:{transitionProperty:"opacity",transitionDuration:"1s",transitionTimingFunction:"ease"},opacity:a?1:.1,children:[Object(c.jsx)("title",{children:O(n)}),Object(c.jsx)("rect",{className:"is-clickable",x:v(new Date(e.time))-p/2,y:x-g(e.tweetCount),width:p,height:g(e.tweetCount),fill:e.color,onClick:function(){0!==l.length&&a?i(W.actions.selectTopics([])):i(W.actions.selectTopics(s.filter((function(e){var t=new Date(e.time),c=new Date(e.stopTime);return n<=c&&t<=r})).map((function(e){return e.id}))))}})]},e.time)}))}),Object(c.jsx)("g",{children:a.map((function(e){var t=j.c().x((function(e){return v(new Date(e.time))}));return u.has(e.id)?t.y((function(t){return w(t.words[e.id])})):t.y((function(){return w(0)})),Object(c.jsx)("g",{className:"is-clickable",onClick:function(){i(W.actions.toggleWord(e.id));var t=Array.from(u),n=t.indexOf(e.id);n<0?t.push(e.id):t.splice(n,1),0===t.size?i(W.actions.selectTopics([])):i(W.actions.selectTopics(s.filter((function(e){var n=e.id,c=0;return t.forEach((function(e){a[e].topicCount[n]<d&&(c=1)})),0===c})).map((function(e){return e.id}))))},children:Object(c.jsx)("path",{style:{transitionPropery:"d",transitionDuration:"1s",transitionTimingFunction:"ease"},d:t(o),fill:"none",opacity:"0.9",stroke:u.has(e.id)?e.color:"none",strokeWidth:"5",children:Object(c.jsx)("title",{children:e.word})})},e.id)}))}),Object(c.jsx)("g",{children:a.map((function(e){if(!u.has(e.id))return null;var t=o.reduce((function(t,n,c){return n.words[e.id]>o[t].words[e.id]?c:t}),0),n=o[t];return Object(c.jsx)("g",{className:"is-clickable",onClick:function(){i(W.actions.toggleWord(e.id));var t=Array.from(u),n=t.indexOf(e.id);n<0?t.push(e.id):t.splice(n,1),0===t.size?i(W.actions.selectTopics([])):i(W.actions.selectTopics(s.filter((function(e){var n=e.id,c=0;return t.forEach((function(e){a[e].topicCount[n]<d&&(c=1)})),0===c})).map((function(e){return e.id}))))},children:Object(c.jsx)("text",{x:v(new Date(n.time)),y:w(n.words[e.id]),textAnchor:"middle",dominantBaseline:"text-after-edge",fontWeight:"700",fontSize:"12",fill:m,children:e.word})},e.id)}))}),Object(c.jsxs)("g",{transform:"translate(0,".concat(x,")"),children:[Object(c.jsx)("line",{x1:"0",y1:"0",x2:h,y2:"0",stroke:m}),Object(c.jsx)("g",{children:v.ticks().map((function(e,t){return Object(c.jsxs)("g",{transform:"translate(".concat(v(e),",0)"),children:[Object(c.jsx)("line",{x1:"0",y1:"0",x2:"0",y2:"5",stroke:m}),Object(c.jsx)("g",{transform:"rotate(-30)",children:Object(c.jsx)("text",{x:"-5",textAnchor:"end",dominantBaseline:"text-before-edge",fontWeight:"700",fontSize:"10",fill:m,children:O(e)})})]},t)}))})]}),Object(c.jsxs)("g",{children:[Object(c.jsx)("text",{transform:"translate(-50,".concat(x/2,")rotate(-90)"),textAnchor:"middle",dominantBaseline:"central",fontWeight:"700",fontSize:"16",fill:m,children:"Tweet Count"}),Object(c.jsx)("line",{x1:"0",y1:x,x2:"0",y2:"0",stroke:m}),Object(c.jsx)("g",{children:g.ticks().map((function(e,t){return Object(c.jsxs)("g",{transform:"translate(0,".concat(x-g(e),")"),children:[Object(c.jsx)("line",{x1:"0",y1:"0",x2:"-5",y2:"0",stroke:m}),Object(c.jsx)("text",{x:"-7",textAnchor:"end",dominantBaseline:"central",fontWeight:"700",fontSize:"12",fill:m,children:e})]},t)}))})]}),Object(c.jsxs)("g",{transform:"translate(".concat(h,",0)"),children:[Object(c.jsx)("text",{transform:"translate(40,".concat(x/2,")rotate(-90)"),textAnchor:"middle",dominantBaseline:"central",fontWeight:"700",fontSize:"16",fill:m,children:"Word Occurrence"}),Object(c.jsx)("line",{x1:"0",y1:x,x2:"0",y2:"0",stroke:m}),Object(c.jsx)("g",{children:w.ticks().map((function(e,t){return Object(c.jsxs)("g",{transform:"translate(0,".concat(w(e),")"),children:[Object(c.jsx)("line",{x1:"0",y1:"0",x2:"5",y2:"0",stroke:m}),Object(c.jsx)("text",{x:"7",textAnchor:"start",dominantBaseline:"central",fontWeight:"700",fontSize:"12",fill:m,children:e})]},t)}))})]})]})})}function E(){return Object(c.jsx)(S,{render:function(e,t){return Object(c.jsx)(B,{width:e,height:t})}})}function R(e){var t=e.width,n=e.height,i=Object(r.b)(),s=Object(r.c)((function(e){return e.topics})),a=Object(r.c)((function(e){return e.words})),o=Object(r.c)((function(e){return e.selectedTopics})),l=Object(r.c)((function(e){var t=e.selectedWords;return new Set(t)})),u=Object(r.c)((function(e){return e.minWordCount})),d=10,j=10,b=t-d-10,f=n-j-10,h=w(a,b,f),x=h.x,m=h.y,p=h.s;return Object(c.jsx)("svg",{viewBox:"0 0 ".concat(t," ").concat(n),children:Object(c.jsx)("g",{transform:"translate(".concat(d,", ").concat(j,")"),children:Object(c.jsx)("g",{transform:"translate(".concat(b/2,",").concat(f/2,")"),children:Object(c.jsx)("g",{transform:"scale(".concat(p,")"),children:Object(c.jsx)("g",{transform:"translate(".concat(-x,",").concat(-m,")"),children:a.map((function(e){var t=0===o.length?e.count:o.reduce((function(t,n){return t+e.topicCount[n]}),0),n=t<u?0:1,r=Math.sqrt(t/e.count);return Object(c.jsxs)("g",{className:"is-clickable",opacity:n,style:{transitionProperty:"opacity",transitionDuration:"1s",transitionTimingFunction:"ease"},transform:"translate(".concat(e.x,", ").concat(e.y,")"),onClick:function(){i(W.actions.toggleWord(e.id));var t=Array.from(l),n=t.indexOf(e.id);n<0?t.push(e.id):t.splice(n,1),0===t.size?i(W.actions.selectTopics([])):i(W.actions.selectTopics(s.filter((function(e){var n=e.id,c=0;return t.forEach((function(e){a[e].topicCount[n]<u&&(c=1)})),0===c})).map((function(e){return e.id}))))},children:[Object(c.jsx)("title",{children:"".concat(e.word)}),Object(c.jsx)("circle",{r:e.r,opacity:r,style:{transitionProperty:"opacity",transitionDuration:"1s",transitionTimingFunction:"ease"},fill:e.color}),Object(c.jsx)("circle",{r:e.r,fill:"none",stroke:l.has(e.id)?"#363636":"none",strokeWidth:"2"}),Object(c.jsx)("text",{className:"is-unselectable",fontSize:e.fontSize,textAnchor:"middle",dominantBaseline:"central",fontWeight:"700",fill:"#363636",children:e.word})]},e.id)}))})})})})})}function F(e){var t=e.words,n=e.selectedTopics,i=Object(r.b)(),s=Object(r.c)((function(e){return e.minWordCount}));return Object(c.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[Object(c.jsx)("div",{className:"p-3",children:Object(c.jsx)(z,{label:"Min Word Count",children:Object(c.jsxs)("div",{className:"field has-addons",children:[Object(c.jsx)("div",{className:"control",children:Object(c.jsx)("button",{disabled:s<=0,className:"button",onClick:function(){i(W.actions.updateMinWordCount(s-1))},children:Object(c.jsx)("span",{className:"icon",children:Object(c.jsx)("i",{className:"fas fa-minus"})})})}),Object(c.jsx)("div",{className:"control is-expanded",children:Object(c.jsx)("input",{className:"input",type:"number",min:"1",value:s,onChange:function(e){i(W.actions.updateMinWordCount(+e.target.value))}})}),Object(c.jsx)("div",{className:"control",children:Object(c.jsx)("button",{className:"button",onClick:function(){i(W.actions.updateMinWordCount(s+1))},children:Object(c.jsx)("span",{className:"icon",children:Object(c.jsx)("i",{className:"fas fa-plus"})})})})]})})}),Object(c.jsx)("div",{style:{position:"absolute",top:"64px",right:0,bottom:0,left:0},children:Object(c.jsx)(S,{render:function(e,i){return Object(c.jsx)(R,{words:t,selectedTopics:n,width:e,height:i})}})})]})}var P=function(){var e=Object(r.b)();return Object(u.useEffect)((function(){Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C();case 2:n=t.sent,e(W.actions.loadData(n));case 4:case"end":return t.stop()}}),t)})))()}),[e]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("nav",{className:"navbar is-info",role:"navigation","aria-label":"main navigation",children:[Object(c.jsx)("div",{className:"navbar-brand",children:Object(c.jsx)("a",{className:"navbar-item",href:".",children:Object(c.jsx)("h1",{children:"Visualization of Twitter Topic Transitions"})})}),Object(c.jsxs)("div",{className:"navbar-menu",children:[Object(c.jsx)("div",{className:"navbar-start",children:Object(c.jsx)("a",{className:"navbar-item",href:".",onClick:function(e){e.preventDefault(),alert("Demo application for viaulization of twitter topic transitions.\nRecommended display resolution: Over Full HD\nDeveloped by: https://vdslab.jp")},children:"About"})}),Object(c.jsx)("div",{className:"navbar-end",children:Object(c.jsx)("div",{className:"navbar-item",children:Object(c.jsxs)("div",{className:"buttons",children:[Object(c.jsx)("button",{className:"button",onClick:function(){e(W.actions.selectTopics([]))},children:"Clear Selection"}),Object(c.jsx)("button",{className:"button",onClick:function(){document.querySelector("#content").requestFullscreen()},children:Object(c.jsx)("span",{className:"icon",children:Object(c.jsx)("i",{className:"fas fa-expand"})})}),Object(c.jsx)("button",{className:"button",onClick:function(){alert("TBD")},children:Object(c.jsx)("span",{className:"icon",children:Object(c.jsx)("i",{className:"fas fa-cogs"})})})]})})})]})]}),Object(c.jsx)("main",{className:"main has-background-info-light",children:Object(c.jsxs)("div",{className:"main-contents",children:[Object(c.jsx)("div",{className:"timeline-view p-3",children:Object(c.jsx)("div",{className:"box is-paddingless is-radiusless",children:Object(c.jsx)(E,{})})}),Object(c.jsx)("div",{className:"projection-view p-3",children:Object(c.jsx)("div",{className:"box is-paddingless is-radiusless",children:Object(c.jsx)(A,{})})}),Object(c.jsx)("div",{className:"word-bubble-view p-3",children:Object(c.jsx)("div",{className:"box is-paddingless is-radiusless",children:Object(c.jsx)(F,{})})})]})})]})},q=Object(s.a)({reducer:W.reducer,middleware:function(e){return e({immutableCheck:!1,serializableCheck:!1})}});Object(i.render)(Object(c.jsx)(r.a,{store:q,children:Object(c.jsx)(P,{})}),document.querySelector("#content"))},71:function(e,t,n){var c=n(28),i=["dbscan"];e.exports=function(){var e=new Worker(n.p+"0122b5b0cedbbdb80a18.worker.js",{name:"[hash].worker.js"});return c(e,i),e}},72:function(e,t,n){var c=n(28),i=["layout"];e.exports=function(){var e=new Worker(n.p+"2fe890b6e5a27f6c73ad.worker.js",{name:"[hash].worker.js"});return c(e,i),e}},73:function(e,t,n){var c=n(28),i=["tsne"];e.exports=function(){var e=new Worker(n.p+"9398b91f8e7660e9636f.worker.js",{name:"[hash].worker.js"});return c(e,i),e}}},[[199,1,2]]]);
//# sourceMappingURL=main.83796490.chunk.js.map